name: PR Preview Comment

on:
  pull_request:
    types: [opened, synchronize]
    branches: [main]
    paths:
      - 'src/**'
      - 'public/**'
      - 'package.json'
      - 'pnpm-lock.yaml'
      - 'next.config.mjs'
      - 'wrangler*.json'

permissions:
  pull-requests: write
  contents: read

jobs:
  preview-comment:
    name: Add Preview Deployment Info
    runs-on: ubuntu-latest

    steps:
      - name: Add PR Comment
        uses: actions/github-script@v7
        with:
          script: |
            const comment = `## ğŸ” Preview Deployment

            é€™å€‹ PR çš„è®Šæ›´å°‡åœ¨åˆä½µå‰é€²è¡Œå“è³ªæª¢æŸ¥:

            âœ… ESLint æª¢æŸ¥
            âœ… TypeScript é¡å‹æª¢æŸ¥

            åˆä½µåˆ° \`main\` åˆ†æ”¯å¾Œæœƒè‡ªå‹•éƒ¨ç½²åˆ°ç”Ÿç”¢ç’°å¢ƒ (https://toolcase.cc)
            åˆä½µåˆ° \`develop\` åˆ†æ”¯å¾Œæœƒè‡ªå‹•éƒ¨ç½²åˆ°é è¦½ç’°å¢ƒ

            ---

            ğŸ’¡ **æç¤º:** ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ [Actions](${context.payload.repository.html_url}/actions/workflows/deploy.yml) é é¢çš„ "Run workflow" æŒ‰éˆ•æ‰‹å‹•è§¸ç™¼éƒ¨ç½²åˆ°æŒ‡å®šç’°å¢ƒã€‚
            `;

            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: comment
            });
